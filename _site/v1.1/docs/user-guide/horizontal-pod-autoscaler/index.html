<!Doctype html>
<html id="docs">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
	<script src="/js/script.js"></script>
    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/non-mini.js"></script>
    <title>Kubernetes - Horizontal Pod Autoscaler</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs" class="button" id="viewDocs">View Documentation</a>
		<a href="/get-started" class="button" id="tryKubernetes">Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="">Get Started</a></h3>
				<p>Built for a multi-cloud world, public, private or hybrid. Seamlessly roll out new features.</p>
			</div>
			<div class="nav-box">
				<h3><a href="">Documentation</a></h3>
				<p>Pellentesque in ipsum id orci porta dapibus. Nulla porttitor accumsan tincidunt. </p>
			</div>
			<div class="nav-box">
				<h3><a href="">Community</a></h3>
				<p>Vestibulum ac diam sit amet quam vehicula elementum sed sit amet dui. </p>
			</div>
			<div class="nav-box">
				<h3><a href="">Blog</a></h3>
				<p>Curabitur arcu erat, accumsan id imperdiet et, porttitor at sem. Quisque velit nisi, pretium ut lacinia in. </p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="" class="button">View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="Twitter"><span>twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>stackoverflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/google-containers" class="mailing-list"><span>Mailing List</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>

<!--  HERO  -->
<section id="hero" class="light-text">
	<h1></h1>
	<h5></h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/v1.1/guides">GUIDES</a></li>
			<li><a href="/v1.1/reference">REFERENCE</a></li>
			<li><a href="/v1.1/samples">SAMPLES</a></li>
			<li><a href="/v1.1/support">SUPPORT</a></li>
		</ul>
		<div class="dropdown">
			<div class="readout"></div>
			<a href="/v1.1">Version 1.1</a>
			<a href="/v1.0">Version 1.0</a>
		</div>
		<input type="text" id="search" placeholder="Search the docs">
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
            
            

        </div> <!-- /pi-accordion -->
	</div> <!-- /docsToc -->
	<div id="docsContent">
    	<h1>Horizontal Pod Autoscaler</h1>
		<!-- BEGIN MUNGE: UNVERSIONED_WARNING -->

<!-- END MUNGE: UNVERSIONED_WARNING -->

<h1 id="horizontal-pod-autoscaler">Horizontal Pod Autoscaler</h1>

<p>This document describes the current state of Horizontal Pod Autoscaler in Kubernetes.</p>

<!-- BEGIN MUNGE: GENERATED_TOC -->

<ul>
  <li><a href="#horizontal-pod-autoscaler">Horizontal Pod Autoscaler</a>
    <ul>
      <li><a href="#what-is-horizontal-pod-autoscaler">What is Horizontal Pod Autoscaler?</a></li>
      <li><a href="#how-does-horizontal-pod-autoscaler-work">How does Horizontal Pod Autoscaler work?</a></li>
      <li><a href="#api-object">API Object</a></li>
      <li><a href="#support-for-horizontal-pod-autoscaler-in-kubectl">Support for horizontal pod autoscaler in kubectl</a></li>
      <li><a href="#autoscaling-during-rolling-update">Autoscaling during rolling update</a></li>
      <li><a href="#further-reading">Further reading</a></li>
    </ul>
  </li>
</ul>

<!-- END MUNGE: GENERATED_TOC -->

<h2 id="what-is-horizontal-pod-autoscaler">What is Horizontal Pod Autoscaler?</h2>

<p>Horizontal pod autoscaling allows the number of pods in a replication controller or deployment
to scale automatically based on observed CPU utilization.
It is a <a href="../api.html#api-versioning">beta</a> feature in Kubernetes 1.1.</p>

<p>The autoscaler is implemented as a Kubernetes API resource and a controller.
The resource describes behavior of the controller.
The controller periodically adjusts the number of replicas in a replication controller or deployment
to match the observed average CPU utilization to the target specified by user.</p>

<h2 id="how-does-horizontal-pod-autoscaler-work">How does Horizontal Pod Autoscaler work?</h2>

<p><img src="horizontal-pod-autoscaler.png" alt="Horizontal Pod Autoscaler diagram" /></p>

<p>The autoscaler is implemented as a control loop.
It periodically queries CPU utilization for the pods it targets.
(The period of the autoscaler is controlled by <code>--horizontal-pod-autoscaler-sync-period</code> flag of controller manager.
The default value is 30 seconds).
Then, it compares the arithmetic mean of the pods’ CPU utilization with the target and adjust the number of replicas if needed.</p>

<p>CPU utilization is the recent CPU usage of a pod divided by the sum of CPU requested by the pod’s containers.
Please note that if some of the pod’s containers do not have CPU request set,
CPU utilization for the pod will not be defined and the autoscaler will not take any action.
Further details of the autoscaling algorithm are given <a href="../design/horizontal-pod-autoscaler.html#autoscaling-algorithm">here</a>.</p>

<p>Autoscaler uses heapster to collect CPU utilization.
Therefore, it is required to deploy heapster monitoring in your cluster for autoscaling to work.</p>

<p>Autoscaler accesses corresponding replication controller or deployment by scale sub-resource.
Scale is an interface which allows to dynamically set the number of replicas and to learn the current state of them.
More details on scale sub-resource can be found <a href="../design/horizontal-pod-autoscaler.html#scale-subresource">here</a>.</p>

<h2 id="api-object">API Object</h2>

<p>Horizontal pod autoscaler is a top-level resource in the Kubernetes REST API (currently in <a href="../api.html#api-versioning">beta</a>).
More details about the API object can be found at
<a href="../design/horizontal-pod-autoscaler.html#horizontalpodautoscaler-object">HorizontalPodAutoscaler Object</a>.</p>

<h2 id="support-for-horizontal-pod-autoscaler-in-kubectl">Support for horizontal pod autoscaler in kubectl</h2>

<p>Horizontal pod autoscaler, like every API resource, is supported in a standard way by <code>kubectl</code>.
We can create a new autoscaler using <code>kubectl create</code> command.
We can list autoscalers by <code>kubectl get hpa</code> and get detailed description by <code>kubectl describe hpa</code>.
Finally, we can delete an autoscaler using <code>kubectl delete hpa</code>.</p>

<p>In addition, there is a special <code>kubectl autoscale</code> command that allows for easy creation of horizontal pod autoscaler.
For instance, executing <code>kubectl autoscale rc foo --min=2 --max=5 --cpu-percent=80</code>
will create an autoscaler for replication controller <em>foo</em>, with target CPU utilization set to <code>80%</code>
and the number of replicas between 2 and 5.
The detailed documentation of <code>kubectl autoscale</code> can be found <a href="kubectl/kubectl_autoscale.html">here</a>.</p>

<h2 id="autoscaling-during-rolling-update">Autoscaling during rolling update</h2>

<p>Currently in Kubernetes, it is possible to perform a rolling update by managing replication controllers directly,
or by using the deployment object, which manages the underlying replication controllers for you.
Horizontal pod autoscaler only supports the latter approach: the horizontal pod autoscaler is bound to the deployment object,
it sets the size for the deployment object, and the deployment is responsible for setting sizes of underlying replication controllers.</p>

<p>Horizontal pod autoscaler does not work with rolling update using direct manipulation of replication controllers,
i.e. you cannot bind a horizontal pod autoscaler to a replication controller and do rolling update (e.g. using <code>kubectl rolling-update</code>).
The reason this doesn’t work is that when rolling update creates a new replication controller,
the horizontal pod autoscaler will not be bound to the new replication controller.</p>

<h2 id="further-reading">Further reading</h2>

<ul>
  <li>Design documentation: <a href="../design/horizontal-pod-autoscaler.html">Horizontal Pod Autoscaling</a>.</li>
  <li>Manual of autoscale command in kubectl: <a href="kubectl/kubectl_autoscale.html">kubectl autoscale</a>.</li>
  <li>Usage example of <a href="horizontal-pod-autoscaling/README.html">Horizontal Pod Autoscaler</a>.</li>
</ul>

<!-- BEGIN MUNGE: IS_VERSIONED -->
<!-- TAG IS_VERSIONED -->
<!-- END MUNGE: IS_VERSIONED -->

<!-- BEGIN MUNGE: GENERATED_ANALYTICS -->
<p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/user-guide/horizontal-pod-autoscaler.md?pixel" alt="Analytics" /></a>
<!-- END MUNGE: GENERATED_ANALYTICS --></p>


	</div>
</section>


<footer>
	<main class="light-text">
		<nav>
			<a href="/getting-started.html">Getting Started</a>
			<a href="/docs.html">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/foobang.html">Community</a>
		</nav>
		<div class="social">
			<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
			<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
			<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>stackoverflow</span></a>
			<a href="https://groups.google.com/forum/#!forum/google-containers" class="mailing-list"><span>Mailing List</span></a>
			<label for="wishField">I wish this page <input type="text" id="wishField" name="wishField" placeholder="made better textfield suggestions"></label>
		</div>
		<div class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>

</body>
</html>



