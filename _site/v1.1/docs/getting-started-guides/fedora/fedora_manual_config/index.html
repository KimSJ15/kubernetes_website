<!Doctype html>
<html id="docs">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
	<link rel="stylesheet" href="/css/styles.css"/>
	<script src="/js/script.js"></script>
    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/non-mini.js"></script>
    <title>Kubernetes - Getting started on Fedora</title>
</head>
<body>
<div id="cellophane" onclick="kub.toggleMenu()"></div>
<header>
	<a href="/" class="logo"></a>
	<div class="nav-buttons" data-auto-burger="primary">
		<a href="/docs" class="button" id="viewDocs">View Documentation</a>
		<a href="/get-started" class="button" id="tryKubernetes">Try Kubernetes</a>
		<button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
	</div>

	<nav id="mainNav">
		<main data-auto-burger="primary">
			<div class="nav-box">
				<h3><a href="">Get Started</a></h3>
				<p>Built for a multi-cloud world, public, private or hybrid. Seamlessly roll out new features.</p>
			</div>
			<div class="nav-box">
				<h3><a href="">Documentation</a></h3>
				<p>Pellentesque in ipsum id orci porta dapibus. Nulla porttitor accumsan tincidunt. </p>
			</div>
			<div class="nav-box">
				<h3><a href="">Community</a></h3>
				<p>Vestibulum ac diam sit amet quam vehicula elementum sed sit amet dui. </p>
			</div>
			<div class="nav-box">
				<h3><a href="">Blog</a></h3>
				<p>Curabitur arcu erat, accumsan id imperdiet et, porttitor at sem. Quisque velit nisi, pretium ut lacinia in. </p>
			</div>
		</main>
		<main data-auto-burger="primary">
			<div class="left">
				<h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
				<a href="" class="button">View On Github</a>
			</div>

			<div class="right">
				<h5 class="github-invite">Explore the community</h5>
				<div class="social">
					<a href="https://twitter.com/kubernetesio" class="Twitter"><span>twitter</span></a>
					<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
					<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
					<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>stackoverflow</span></a>
					<a href="https://groups.google.com/forum/#!forum/google-containers" class="mailing-list"><span>Mailing List</span></a>
				</div>
			</div>
			<div class="clear" style="clear: both"></div>
		</main>
	</nav>
</header>

<!--  HERO  -->
<section id="hero" class="light-text">
	<h1></h1>
	<h5></h5>
	<div id="vendorStrip" class="light-text">
		<ul>
			<li><a href="/v1.1/">GUIDES</a></li>
			<li><a href="/v1.1/reference">REFERENCE</a></li>
			<li><a href="/v1.1/samples">SAMPLES</a></li>
			<li><a href="/v1.1/support">SUPPORT</a></li>
		</ul>
		<div class="dropdown">
			<div class="readout"></div>
			<a href="/v1.1">Version 1.1</a>
			<a href="/v1.0">Version 1.0</a>
		</div>
		<input type="text" id="search" placeholder="Search the docs">
	</div>
</section>

<section id="encyclopedia">
	<div id="docsToc">
        <div class="pi-accordion">
            
            

        </div> <!-- /pi-accordion -->
	</div> <!-- /docsToc -->
	<div id="docsContent">
    	<h1>Getting started on Fedora</h1>
		<!-- BEGIN MUNGE: UNVERSIONED_WARNING -->

<!-- END MUNGE: UNVERSIONED_WARNING -->
<p>Getting started on <a href="http://fedoraproject.org">Fedora</a>
—————————————————–</p>

<p><strong>Table of Contents</strong></p>

<ul>
  <li><a href="#prerequisites">Prerequisites</a></li>
  <li><a href="#instructions">Instructions</a></li>
</ul>

<h2 id="prerequisites">Prerequisites</h2>

<ol>
  <li>You need 2 or more machines with Fedora installed.</li>
</ol>

<h2 id="instructions">Instructions</h2>

<p>This is a getting started guide for Fedora.  It is a manual configuration so you understand all the underlying packages / services / ports, etc…</p>

<p>This guide will only get ONE node (previously minion) working.  Multiple nodes require a functional <a href="../../admin/networking.html">networking configuration</a> done outside of Kubernetes.  Although the additional Kubernetes configuration requirements should be obvious.</p>

<p>The Kubernetes package provides a few services: kube-apiserver, kube-scheduler, kube-controller-manager, kubelet, kube-proxy.  These services are managed by systemd and the configuration resides in a central location: /etc/kubernetes.  We will break the services up between the hosts.  The first host, fed-master, will be the Kubernetes master.  This host will run the kube-apiserver, kube-controller-manager, and kube-scheduler.  In addition, the master will also run <em>etcd</em> (not needed if <em>etcd</em> runs on a different host but this guide assumes that <em>etcd</em> and Kubernetes master run on the same host).  The remaining host, fed-node will be the node and run kubelet, proxy and docker.</p>

<p><strong>System Information:</strong></p>

<p>Hosts:</p>

<pre><code>
fed-master = 192.168.121.9
fed-node = 192.168.121.65

</code></pre>

<p><strong>Prepare the hosts:</strong></p>

<ul>
  <li>Install Kubernetes on all hosts - fed-{master,node}.  This will also pull in docker. Also install etcd on fed-master.  This guide has been tested with kubernetes-0.18 and beyond.</li>
  <li>The <a href="https://fedoraproject.org/wiki/QA:Updates_Testing">–enablerepo=updates-testing</a> directive in the yum command below will ensure that the most recent Kubernetes version that is scheduled for pre-release will be installed. This should be a more recent version than the Fedora “stable” release for Kubernetes that you would get without adding the directive.</li>
  <li>If you want the very latest Kubernetes release <a href="http://koji.fedoraproject.org/koji/packageinfo?packageID=19202">you can download and yum install the RPM directly from Fedora Koji</a> instead of using the yum install command below.</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">yum -y install --enablerepo=updates-testing kubernetes
</code></pre>
</div>

<ul>
  <li>Install etcd and iptables</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">yum -y install etcd iptables
</code></pre>
</div>

<ul>
  <li>Add master and node to /etc/hosts on all machines (not needed if hostnames already in DNS). Make sure that communication works between fed-master and fed-node by using a utility such as ping.</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">echo "192.168.121.9	fed-master
192.168.121.65	fed-node" &gt;&gt; /etc/hosts
</code></pre>
</div>

<ul>
  <li>Edit /etc/kubernetes/config which will be the same on all hosts (master and node) to contain:</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh"># Comma separated list of nodes in the etcd cluster
KUBE_MASTER="--master=http://fed-master:8080"

# logging to stderr means we get it in the systemd journal
KUBE_LOGTOSTDERR="--logtostderr=true"

# journal message level, 0 is debug
KUBE_LOG_LEVEL="--v=0"

# Should this cluster be allowed to run privileged docker containers
KUBE_ALLOW_PRIV="--allow-privileged=false"
</code></pre>
</div>

<ul>
  <li>Disable the firewall on both the master and node, as docker does not play well with other firewall rule managers.  Please note that iptables-services does not exist on default fedora server install.</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">systemctl disable iptables-services firewalld
systemctl stop iptables-services firewalld
</code></pre>
</div>

<p><strong>Configure the Kubernetes services on the master.</strong></p>

<ul>
  <li>Edit /etc/kubernetes/apiserver to appear as such.  The service-cluster-ip-range IP addresses must be an unused block of addresses, not used anywhere else.  They do not need to be routed or assigned to anything.</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh"># The address on the local server to listen to.
KUBE_API_ADDRESS="--address=0.0.0.0"

# Comma separated list of nodes in the etcd cluster
KUBE_ETCD_SERVERS="--etcd-servers=http://127.0.0.1:4001"

# Address range to use for services
KUBE_SERVICE_ADDRESSES="--service-cluster-ip-range=10.254.0.0/16"

# Add your own!
KUBE_API_ARGS=""
</code></pre>
</div>

<ul>
  <li>Edit /etc/etcd/etcd.conf,let the etcd to listen all the ip instead of 127.0.0.1, if not, you will get the error like “connection refused”. Note that Fedora 22 uses etcd 2.0, One of the changes in etcd 2.0 is that now uses port 2379 and 2380 (as opposed to etcd 0.46 which userd 4001 and 7001).</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">ETCD_LISTEN_CLIENT_URLS="http://0.0.0.0:4001"
</code></pre>
</div>

<ul>
  <li>Create /var/run/kubernetes on master:</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">mkdir /var/run/kubernetes
chown kube:kube /var/run/kubernetes
chmod 750 /var/run/kubernetes
</code></pre>
</div>

<ul>
  <li>Start the appropriate services on master:</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">for SERVICES in etcd kube-apiserver kube-controller-manager kube-scheduler; do
	systemctl restart $SERVICES
	systemctl enable $SERVICES
	systemctl status $SERVICES
done
</code></pre>
</div>

<ul>
  <li>
    <p>Addition of nodes:</p>
  </li>
  <li>
    <p>Create following node.json file on Kubernetes master node:</p>
  </li>
</ul>

<div class="highlight">
  <pre><code class="language-json">{
    "apiVersion": "v1",
    "kind": "Node",
    "metadata": {
        "name": "fed-node",
        "labels":{ "name": "fed-node-label"}
    },
    "spec": {
        "externalID": "fed-node"
    }
}
</code></pre>
</div>

<p>Now create a node object internally in your Kubernetes cluster by running:</p>

<div class="highlight">
  <pre><code class="language-console">$ kubectl create -f ./node.json

$ kubectl get nodes
NAME                LABELS              STATUS
fed-node           name=fed-node-label     Unknown
</code></pre>
</div>

<p>Please note that in the above, it only creates a representation for the node
<em>fed-node</em> internally. It does not provision the actual <em>fed-node</em>. Also, it
is assumed that <em>fed-node</em> (as specified in <code>name</code>) can be resolved and is
reachable from Kubernetes master node. This guide will discuss how to provision
a Kubernetes node (fed-node) below.</p>

<p><strong>Configure the Kubernetes services on the node.</strong></p>

<p><strong><em>We need to configure the kubelet on the node.</em></strong></p>

<ul>
  <li>Edit /etc/kubernetes/kubelet to appear as such:</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">###
# Kubernetes kubelet (node) config

# The address for the info server to serve on (set to 0.0.0.0 or "" for all interfaces)
KUBELET_ADDRESS="--address=0.0.0.0"

# You may leave this blank to use the actual hostname
KUBELET_HOSTNAME="--hostname-override=fed-node"

# location of the api-server
KUBELET_API_SERVER="--api-servers=http://fed-master:8080"

# Add your own!
#KUBELET_ARGS=""
</code></pre>
</div>

<ul>
  <li>Start the appropriate services on the node (fed-node).</li>
</ul>

<div class="highlight">
  <pre><code class="language-sh">for SERVICES in kube-proxy kubelet docker; do 
    systemctl restart $SERVICES
    systemctl enable $SERVICES
    systemctl status $SERVICES 
done
</code></pre>
</div>

<ul>
  <li>Check to make sure now the cluster can see the fed-node on fed-master, and its status changes to <em>Ready</em>.</li>
</ul>

<div class="highlight">
  <pre><code class="language-console">kubectl get nodes
NAME                LABELS              STATUS
fed-node          name=fed-node-label     Ready
</code></pre>
</div>

<ul>
  <li>Deletion of nodes:</li>
</ul>

<p>To delete <em>fed-node</em> from your Kubernetes cluster, one should run the following on fed-master (Please do not do it, it is just for information):</p>

<div class="highlight">
  <pre><code class="language-sh">kubectl delete -f ./node.json
</code></pre>
</div>

<p><em>You should be finished!</em></p>

<p><strong>The cluster should be running! Launch a test pod.</strong></p>

<p>You should have a functional cluster, check out <a href="../../../docs/user-guide/walkthrough/README.html">101</a>!</p>

<!-- BEGIN MUNGE: IS_VERSIONED -->
<!-- TAG IS_VERSIONED -->
<!-- END MUNGE: IS_VERSIONED -->

<!-- BEGIN MUNGE: GENERATED_ANALYTICS -->
<p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/getting-started-guides/fedora/fedora_manual_config.md?pixel" alt="Analytics" /></a>
<!-- END MUNGE: GENERATED_ANALYTICS --></p>


	</div>
</section>


<footer>
	<main class="light-text">
		<nav>
			<a href="/getting-started.html">Getting Started</a>
			<a href="/docs.html">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/foobang.html">Community</a>
		</nav>
		<div class="social">
			<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
			<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
			<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>stackoverflow</span></a>
			<a href="https://groups.google.com/forum/#!forum/google-containers" class="mailing-list"><span>Mailing List</span></a>
			<label for="wishField">I wish this page <input type="text" id="wishField" name="wishField" placeholder="made better textfield suggestions"></label>
		</div>
		<div class="center">&copy; 2016 Kubernetes</div>
	</main>
</footer>

</body>
</html>



